<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mewtro - For You</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary-pink: #FF7EB9;
            --soft-pink: #FFC0CB;
            --dark-bg: #000000;
            --light-text: #ffffff;
            --border-radius-lg: 25px;
            --border-radius-md: 15px;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Kanit', sans-serif;
            overflow: hidden; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô */
            background-color: var(--dark-bg); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô TikTok */
            color: var(--light-text);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* --- ‡∏Å‡∏£‡∏≠‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á --- */
        .phone-mockup {
            width: 100%;
            max-width: 400px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            height: 100%;
            max-height: 800px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            background-color: var(--dark-bg);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.5);
        }

        /* --- ‡∏™‡πà‡∏ß‡∏ô Header (‡πÅ‡∏ñ‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô) --- */
        .header {
            background-color: var(--dark-bg);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 10;
        }
        .header .search-bar {
            flex-grow: 1;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius-md);
            padding: 8px 15px;
            color: var(--light-text);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .header .search-bar input {
            background: none;
            border: none;
            color: var(--light-text);
            width: 100%;
            font-size: 1rem;
        }
        .header .search-bar input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        .header .search-icon {
            color: rgba(255, 255, 255, 0.6);
        }

        /* --- ‡∏™‡πà‡∏ß‡∏ô Main Content --- */
        .main-content {
            flex-grow: 1;
            position: relative;
            overflow: hidden; /* ‡πÉ‡∏´‡πâ‡πÅ‡∏ï‡πà‡∏•‡∏∞ screen ‡∏≠‡∏¢‡∏π‡πà‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡∏ô‡∏µ‡πâ */
        }

        .screen {
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô */
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: var(--primary-pink); /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤ */
            animation: fadeIn 0.5s ease-in-out;
            padding: 20px;
            box-sizing: border-box;
            color: white;
            text-align: center;
        }

        .screen.active { display: flex; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- ‡∏™‡πà‡∏ß‡∏ô Footer (‡πÅ‡∏ñ‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á) --- */
        .footer {
            background-color: var(--dark-bg);
            padding: 10px 0;
            display: flex;
            justify-content: space-around;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 10;
        }
        .footer-item {
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.75rem;
            text-align: center;
            cursor: pointer;
        }
        .footer-item i { font-size: 1.2rem; margin-bottom: 3px; }
        .footer-item.active { color: var(--light-text); }

        /* --- Passcode Screen --- */
        #passcode-screen { background-color: var(--dark-bg); } /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å */
        .passcode-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: var(--border-radius-lg);
            text-align: center;
            max-width: 300px;
            width: 100%;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .passcode-box p { font-size: 1.1rem; margin-bottom: 20px; }
        #dots { font-size: 1.5rem; letter-spacing: 5px; margin-bottom: 20px; }
        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        .keypad button {
            width: 60px; height: 60px;
            border-radius: 50%;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: var(--light-text);
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        .keypad button:active { background: rgba(255, 255, 255, 0.4); }

        /* --- Envelope Screen --- */
        #envelope-screen .envelope-wrapper {
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        #envelope-screen .message-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 30px;
        }
        .envelope {
            width: 200px;
            height: 120px;
            background: #f08080; /* ‡πÅ‡∏î‡∏á‡∏≠‡∏°‡∏ä‡∏°‡∏û‡∏π */
            position: relative;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.5s ease;
            transform-origin: bottom;
            overflow: hidden;
        }
        .envelope::before { /* ‡∏ù‡∏≤‡∏ã‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô */
            content: '';
            position: absolute;
            top: -100px; /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≤‡∏°‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° */
            left: 0;
            border-left: 100px solid transparent;
            border-right: 100px solid transparent;
            border-bottom: 100px solid #f08080;
            transform-origin: bottom;
            transition: transform 0.5s ease;
        }
        .envelope.open::before {
            transform: rotateX(180deg); /* ‡πÄ‡∏õ‡∏¥‡∏î‡∏ù‡∏≤‡∏ã‡∏≠‡∏á */
        }
        .letter-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            color: #333;
            padding: 20px;
            box-sizing: border-box;
            border-radius: 10px;
            transform: translateY(100%); /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
            transition: transform 0.8s ease-out;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        .envelope.open .letter-content {
            transform: translateY(0); /* ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ */
        }
        .letter-content h3 { color: var(--primary-pink); margin-bottom: 10px; }
        .letter-content p { font-size: 0.9rem; line-height: 1.5; }

        /* --- Timer Screen --- */
        .timer-card {
            background: rgba(255,255,255,0.2);
            padding: 30px;
            border-radius: var(--border-radius-lg);
            backdrop-filter: blur(10px);
            max-width: 320px;
            width: 100%;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            color: var(--light-text);
        }
        .timer-card h2 { margin-bottom: 25px; font-size: 1.8rem; }
        .timer-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        .time-box {
            background: var(--light-text);
            color: var(--primary-pink);
            padding: 15px;
            border-radius: var(--border-radius-md);
            font-weight: bold;
            font-size: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .time-box span { font-size: 2.2rem; display: block; font-weight: 700; margin-bottom: 5px; }

        /* --- Puzzle Screen --- */
        #puzzle-screen { background-color: var(--primary-pink); }
        .puzzle-container {
            width: 250px; height: 250px;
            background: rgba(0,0,0,0.1);
            border-radius: var(--border-radius-md);
            position: relative;
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 3x3 puzzle */
            grid-template-rows: repeat(3, 1fr);
            gap: 2px; /* ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå */
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .puzzle-piece {
            background-image: url('URL_‡∏£‡∏π‡∏õ‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì'); /* ‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡∏±‡∏î */
            background-size: 300% 300%; /* ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 3x3 */
            background-repeat: no-repeat;
            border: 1px solid rgba(255,255,255,0.3);
            cursor: grab;
            transition: transform 0.1s ease;
        }
        /* ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡∏¥‡πâ‡∏ô‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå (‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏≠‡∏á) */
        .puzzle-piece:nth-child(1) { background-position: 0% 0%; }
        .puzzle-piece:nth-child(2) { background-position: 50% 0%; }
        .puzzle-piece:nth-child(3) { background-position: 100% 0%; }
        .puzzle-piece:nth-child(4) { background-position: 0% 50%; }
        .puzzle-piece:nth-child(5) { background-position: 50% 50%; }
        .puzzle-piece:nth-child(6) { background-position: 100% 50%; }
        .puzzle-piece:nth-child(7) { background-position: 0% 100%; }
        .puzzle-piece:nth-child(8) { background-position: 50% 100%; }
        .puzzle-piece:nth-child(9) { background-position: 100% 100%; }
        /* ‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏à‡∏∞‡πÉ‡∏ä‡πâ JS ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°) */

        /* --- Photo Screen --- */
        #photo-screen .photo-display {
            width: 90%;
            max-width: 300px;
            height: 350px;
            background: var(--bg-white);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        #photo-screen .photo-display img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        #photo-screen .caption {
            font-size: 1.2rem;
            margin-top: 25px;
            font-weight: bold;
        }

        /* --- ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ --- */
        .btn-action {
            background: var(--light-text);
            color: var(--primary-pink);
            border: none;
            padding: 12px 30px;
            border-radius: var(--border-radius-lg);
            font-weight: bold;
            font-size: 1rem;
            margin-top: 30px;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: background 0.2s ease;
        }
        .btn-action:active { background: #eee; }

    </style>
</head>
<body>

    <div class="phone-mockup">
        <div class="header">
            <i class="fas fa-arrow-left"></i>
            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á" disabled>
            </div>
            <i class="fas fa-ellipsis-h"></i>
        </div>

        <div class="main-content">

            <div id="passcode-screen" class="screen active">
                <div class="passcode-box">
                    <p>‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å ‚ù§Ô∏è</p>
                    <div id="dots">_ _ _ _</div>
                    <div class="keypad" id="keypad">
                        <button onclick="press(1)">1</button><button onclick="press(2)">2</button><button onclick="press(3)">3</button>
                        <button onclick="press(4)">4</button><button onclick="press(5)">5</button><button onclick="press(6)">6</button>
                        <button onclick="press(7)">7</button><button onclick="press(8)">8</button><button onclick="press(9)">9</button>
                        <span></span><button onclick="press(0)">0</button><span></span>
                    </div>
                </div>
            </div>

            <div id="envelope-screen" class="screen">
                <div class="envelope-wrapper">
                    <h2 class="message-title">‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏â‡∏±‡∏ô‡∏ñ‡∏∂‡∏á‡πÄ‡∏ò‡∏≠ ‚ù§Ô∏è</h2>
                    <div class="envelope" onclick="openEnvelope(this)">
                        <div class="letter-content">
                            <h3>Happy Valentine's Day!</h3>
                            <p>‡∏£‡∏±‡∏Å‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡πÜ ‡∏ß‡∏±‡∏ô‡∏î‡∏µ‡πÜ ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏ò‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ</p>
                            <p>‡∏à‡∏≤‡∏Å: [‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì]</p>
                        </div>
                    </div>
                </div>
                <button class="btn-action" onclick="nextScreen('timer-screen')" style="display: none;" id="envelope-next-btn">‡∏î‡∏π‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
            </div>

            <div id="timer-screen" class="screen">
                <div class="timer-card">
                    <div style="font-size: 50px;">üê∂</div>
                    <h2>‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡πÅ‡∏•‡πâ‡∏ß</h2>
                    <div class="timer-grid">
                        <div class="time-box"><span id="days">0</span>‡∏ß‡∏±‡∏ô</div>
                        <div class="time-box"><span id="hours">0</span>‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á</div>
                        <div class="time-box"><span id="mins">0</span>‡∏ô‡∏≤‡∏ó‡∏µ</div>
                        <div class="time-box"><span id="secs">0</span>‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</div>
                    </div>
                    <button class="btn-action" onclick="nextScreen('puzzle-screen')">‡∏ï‡πà‡∏≠‡πÑ‡∏õ</button>
                </div>
            </div>

            <div id="puzzle-screen" class="screen">
                <h2>‡∏ï‡πà‡∏≠‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏£‡∏π‡∏õ‡πÄ‡∏£‡∏≤‡∏™‡∏¥ ‚ù§Ô∏è</h2>
                <p>‡∏•‡∏≤‡∏Å‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</p>
                <div class="puzzle-container" id="puzzle-container">
                    </div>
                <button class="btn-action" onclick="nextScreen('photo-screen')" style="display: none;" id="puzzle-next-btn">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤</button>
            </div>

            <div id="photo-screen" class="screen">
                <div class="photo-display">
                    <img src="URL_‡∏£‡∏π‡∏õ‡∏Ñ‡∏π‡πà_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì" alt="Our Couple Photo">
                </div>
                <p class="caption">"‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏•‡∏¢‡∏ô‡∏∞ ‚ù§Ô∏è"</p>
                <button class="btn-action" onclick="location.reload()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà</button>
            </div>

        </div>

        <div class="footer">
            <div class="footer-item active"><i class="fas fa-home"></i><span>Home</span></div>
            <div class="footer-item"><i class="fas fa-users"></i><span>Friends</span></div>
            <div class="footer-item"><i class="fas fa-plus-square"></i><span>Add</span></div>
            <div class="footer-item"><i class="fas fa-heart"></i><span>Likes</span></div>
            <div class="footer-item"><i class="fas fa-user-circle"></i><span>Profile</span></div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/Draggable.min.js"></script>
    <script>
        // --- Global Variables ---
        let currentScreen = 'passcode-screen'; // ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        const correctPin = "1402"; // ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ)
        const startDate = new Date(2025, 1, 14, 0, 0, 0); // ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏ö‡∏Å‡∏±‡∏ô (‡∏õ‡∏µ, ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô-1, ‡∏ß‡∏±‡∏ô, ‡∏ä‡∏°., ‡∏ô.)
        let inputPin = "";
        let puzzleSolved = false;

        // --- Function: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ---
        function nextScreen(screenId) {
            document.getElementById(currentScreen).classList.remove('active');
            document.getElementById(screenId).classList.add('active');
            currentScreen = screenId;

            if (screenId === 'timer-screen') startTimer();
            if (screenId === 'puzzle-screen') initializePuzzle();
        }

        // --- Screen 1: Passcode Logic ---
        function press(num) {
            inputPin += num;
            document.getElementById('dots').innerText = "* ".repeat(inputPin.length) + "_ ".repeat(4 - inputPin.length);

            if (inputPin.length === 4) {
                if (inputPin === correctPin) {
                    setTimeout(() => nextScreen('envelope-screen'), 300);
                } else {
                    alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞!");
                    inputPin = "";
                    document.getElementById('dots').innerText = "_ _ _ _";
                }
            }
        }

        // --- Screen 2: Envelope Logic ---
        function openEnvelope(envelopeElement) {
            envelopeElement.classList.add('open');
            setTimeout(() => {
                document.getElementById('envelope-next-btn').style.display = 'block';
            }, 1000); // ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏ú‡∏•‡πà‡∏°‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏õ‡∏¥‡∏î
        }

        // --- Screen 3: Timer Logic ---
        let timerInterval;
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval); // Clear existing interval if any
            timerInterval = setInterval(() => {
                const now = new Date();
                const diff = now - startDate;

                const d = Math.floor(diff / (1000 * 60 * 60 * 24));
                const h = Math.floor((diff / (1000 * 60 * 60)) % 24);
                const m = Math.floor((diff / 1000 / 60) % 60);
                const s = Math.floor((diff / 1000) % 60);

                document.getElementById('days').innerText = d;
                document.getElementById('hours').innerText = h;
                document.getElementById('mins').innerText = m;
                document.getElementById('secs').innerText = s;
            }, 1000);
        }

        // --- Screen 4: Puzzle Logic ---
        let puzzlePieces = [];
        let shuffledPositions = [];
        const PUZZLE_SIZE = 3; // For a 3x3 puzzle

        function initializePuzzle() {
            const container = document.getElementById('puzzle-container');
            container.innerHTML = ''; // Clear previous pieces

            puzzlePieces = [];
            for (let i = 0; i < PUZZLE_SIZE * PUZZLE_SIZE; i++) {
                const piece = document.createElement('div');
                piece.classList.add('puzzle-piece');
                piece.dataset.index = i; // Store correct index
                // Calculate background position for each piece
                const col = i % PUZZLE_SIZE;
                const row = Math.floor(i / PUZZLE_SIZE);
                piece.style.backgroundPosition = `${(col / (PUZZLE_SIZE - 1)) * 100}% ${(row / (PUZZLE_SIZE - 1)) * 100}%`;
                piece.style.backgroundSize = `${PUZZLE_SIZE * 100}% ${PUZZLE_SIZE * 100}%`;
                piece.style.backgroundImage = "url('URL_‡∏£‡∏π‡∏õ‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå_‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì')"; // **‡πÉ‡∏™‡πà‡∏£‡∏π‡∏õ‡∏à‡∏¥‡πä‡∏Å‡∏ã‡∏≠‡∏ß‡πå‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ**
                
                puzzlePieces.push(piece);
            }

            shufflePieces(); // ‡∏™‡∏∏‡πà‡∏°‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
            renderPuzzle();
            makePiecesDraggable();
        }

        function shufflePieces() {
            shuffledPositions = Array.from({ length: puzzlePieces.length }, (_, i) => i);
            for (let i = shuffledPositions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledPositions[i], shuffledPositions[j]] = [shuffledPositions[j], shuffledPositions[i]];
            }
        }

        function renderPuzzle() {
            const container = document.getElementById('puzzle-container');
            container.innerHTML = '';
            shuffledPositions.forEach(originalIndex => {
                container.appendChild(puzzlePieces[originalIndex]);
            });
        }

        function makePiecesDraggable() {
            gsap.registerPlugin(Draggable);
            Draggable.create(".puzzle-piece", {
                bounds: "#puzzle-container",
                onDragEnd: function() {
                    // This is a simplified check. A proper puzzle check needs to verify positions.
                    // For now, let's assume if they drag, they are trying to solve it.
                    checkPuzzleCompletion();
                }
            });
        }

        function checkPuzzleCompletion() {
            // A more robust check would involve comparing each piece's final position/index
            // to its correct original index within the container's grid.
            // For simplicity, we'll just enable the next button after a few drags.
            // In a real puzzle, you'd calculate if all pieces are in their correct spots.

            // Simulate completion for now
            if (!puzzleSolved) {
                setTimeout(() => {
                    alert("‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!");
                    puzzleSolved = true;
                    document.getElementById('puzzle-next-btn').style.display = 'block';
                }, 500); // Small delay to simulate check
            }
        }


        // --- Initialize on load ---
        document.addEventListener('DOMContentLoaded', () => {
            nextScreen('passcode-screen'); // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ passcode
        });
    </script>
</body>
</html>
